# Cursor Rules - BNI GestÃ£o ImobiliÃ¡ria

## ğŸ“‹ Regras Gerais

- Sempre use dados reais do arquivo `data/raw/propriedades.csv` em exemplos
- Nunca use dados fictÃ­cios como "FAMILIA_SILVA", "Ed. Mariner", "BalneÃ¡rio CamboriÃº"
- CÃ³digo de famÃ­lia oficial: `BNI_GESTAO_IMOBILIARIA`
- Nome da famÃ­lia oficial: `BNI GestÃ£o ImobiliÃ¡ria`

## ğŸ—ï¸ Arquitetura e Estrutura

- Schema PostgreSQL estÃ¡ em `scripts/init.sql` (fonte oficial)
- Script `init_database.py` executa `init.sql` completo - nunca criar schema manualmente
- Todos os scripts devem usar variÃ¡veis de ambiente do arquivo `.env`
- Use `load_secrets_1p.sh` para carregar secrets do 1Password automaticamente

## ğŸ“Š Dados e Templates

### Dados Oficiais

- **Fonte Ãºnica de verdade**: `data/raw/propriedades.csv`
- **Total de propriedades**: 38 imÃ³veis reais
- **Exemplos reais**: Use `templates/exemplos_reais_propriedades.json` para referÃªncia

### Templates

- **LocalizaÃ§Ã£o**: `templates/`
- **DocumentaÃ§Ã£o**: `templates/README_TEMPLATES.md`
- **Schema SQL**: `templates/imob_schema.sql` (usar apenas como referÃªncia)
- **ETL**: `templates/etl.py` (processa PDFs para JSON normalizado)

### Regras para Templates

1. **SEMPRE** use dados reais do CSV em exemplos
2. **NUNCA** use dados fictÃ­cios como:
   - âŒ "FAMILIA_SILVA" â†’ âœ… "BNI_GESTAO_IMOBILIARIA"
   - âŒ "Ed. Mariner" â†’ âœ… "APTO 802 EDF.EMILIO BUMACHAR"
   - âŒ "BalneÃ¡rio CamboriÃº" â†’ âœ… "Vila Velha" (ou outras cidades reais)
3. **SEMPRE** referencie `data/raw/propriedades.csv` como fonte oficial
4. **VERIFIQUE** se exemplos estÃ£o atualizados antes de usar

## ğŸ³ Docker e VPS

- Use `docker-compose.prod.yml` para produÃ§Ã£o na VPS
- Use `docker-compose.yml` para desenvolvimento local
- Execute `scripts/auditoria_docker_completa.sh` antes de deploy na VPS
- Verifique conflitos de portas e containers existentes

## ğŸ” SeguranÃ§a e Secrets

- Use 1Password para gerenciar secrets
- Cofre macOS: `1p_macos`
- Cofre VPS: `1p_vps`
- GH_TOKEN estÃ¡ oficializado em ambos os cofres
- Use `load_secrets_1p.sh` para carregar secrets automaticamente

## ğŸ”„ Git e Branches

- Branch padrÃ£o: `main` (nÃ£o usar `teab` ou outras)
- Todos os workflows GitHub Actions devem usar `main`
- Use scripts enterprise para gerenciar branches em escala

## ğŸ“ DocumentaÃ§Ã£o

- ADRs estÃ£o em `docs/ADR/`
- Guias de setup estÃ£o em `docs/SETUP_*.md`
- DocumentaÃ§Ã£o de templates estÃ¡ em `templates/README_TEMPLATES.md`
- Sempre atualize documentaÃ§Ã£o quando fizer mudanÃ§as

## ğŸ§ª Testes e ValidaÃ§Ã£o

- Execute `make validate-schemas` antes de commit
- Use `make test` para executar testes
- Valide schemas CSV antes de importar dados

## ğŸš€ Deploy

- Deploy automÃ¡tico via GitHub Actions
- Workflow: `.github/workflows/deploy-postgres.yml`
- Executa auditoria Docker antes de deploy
- Usa `init_database.py` que executa `init.sql` completo

## âš ï¸ Avisos Importantes

- **NÃƒO** crie schemas manualmente - sempre use `init.sql`
- **NÃƒO** use dados fictÃ­cios em templates ou exemplos
- **SEMPRE** verifique conflitos Docker antes de criar containers
- **SEMPRE** use dados reais do CSV em documentaÃ§Ã£o e exemplos
- **NUNCA** commite arquivos `.env` ou secrets

